{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _FactoryMaker = require('../../core/FactoryMaker');\n\nvar _FactoryMaker2 = _interopRequireDefault(_FactoryMaker);\n\nvar _SupervisorTools = require('../utils/SupervisorTools');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/**\n* The copyright in this software is being made available under the BSD License,\n* included below. This software may be subject to other third party and contributor\n* rights, including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2013, Dash Industry Forum.\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification,\n* are permitted provided that the following conditions are met:\n*  * Redistributions of source code must retain the above copyright notice, this\n*  list of conditions and the following disclaimer.\n*  * Redistributions in binary form must reproduce the above copyright notice,\n*  this list of conditions and the following disclaimer in the documentation and/or\n*  other materials provided with the distribution.\n*  * Neither the name of Dash Industry Forum nor the names of its\n*  contributors may be used to endorse or promote products derived from this software\n*  without specific prior written permission.\n*\n*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n*  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n*  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n*  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n*  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n*  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n*  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n*  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n*  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n*  POSSIBILITY OF SUCH DAMAGE.\n*/\n\n\nfunction CustomTimeRanges()\n/*config*/\n{\n  var customTimeRangeArray = [];\n  var length = 0;\n\n  function add(start, end) {\n    var i = 0;\n\n    for (i = 0; i < this.customTimeRangeArray.length && start > this.customTimeRangeArray[i].start; i++) {}\n\n    this.customTimeRangeArray.splice(i, 0, {\n      start: start,\n      end: end\n    });\n\n    for (i = 0; i < this.customTimeRangeArray.length - 1; i++) {\n      if (this.mergeRanges(i, i + 1)) {\n        i--;\n      }\n    }\n\n    this.length = this.customTimeRangeArray.length;\n  }\n\n  function clear() {\n    this.customTimeRangeArray = [];\n    this.length = 0;\n  }\n\n  function remove(start, end) {\n    for (var i = 0; i < this.customTimeRangeArray.length; i++) {\n      if (start <= this.customTimeRangeArray[i].start && end >= this.customTimeRangeArray[i].end) {\n        //      |--------------Range i-------|\n        //|---------------Range to remove ---------------|\n        //    or\n        //|--------------Range i-------|\n        //|--------------Range to remove ---------------|\n        //    or\n        //                 |--------------Range i-------|\n        //|--------------Range to remove ---------------|\n        this.customTimeRangeArray.splice(i, 1);\n        i--;\n      } else if (start > this.customTimeRangeArray[i].start && end < this.customTimeRangeArray[i].end) {\n        //|-----------------Range i----------------|\n        //        |-------Range to remove -----|\n        this.customTimeRangeArray.splice(i + 1, 0, {\n          start: end,\n          end: this.customTimeRangeArray[i].end\n        });\n        this.customTimeRangeArray[i].end = start;\n        break;\n      } else if (start > this.customTimeRangeArray[i].start && start < this.customTimeRangeArray[i].end) {\n        //|-----------Range i----------|\n        //                    |---------Range to remove --------|\n        //    or\n        //|-----------------Range i----------------|\n        //            |-------Range to remove -----|\n        this.customTimeRangeArray[i].end = start;\n      } else if (end > this.customTimeRangeArray[i].start && end < this.customTimeRangeArray[i].end) {\n        //                     |-----------Range i----------|\n        //|---------Range to remove --------|\n        //            or\n        //|-----------------Range i----------------|\n        //|-------Range to remove -----|\n        this.customTimeRangeArray[i].start = end;\n      }\n    }\n\n    this.length = this.customTimeRangeArray.length;\n  }\n\n  function mergeRanges(rangeIndex1, rangeIndex2) {\n    var range1 = this.customTimeRangeArray[rangeIndex1];\n    var range2 = this.customTimeRangeArray[rangeIndex2];\n\n    if (range1.start <= range2.start && range2.start <= range1.end && range1.end <= range2.end) {\n      //|-----------Range1----------|\n      //                    |-----------Range2----------|\n      range1.end = range2.end;\n      this.customTimeRangeArray.splice(rangeIndex2, 1);\n      return true;\n    } else if (range2.start <= range1.start && range1.start <= range2.end && range2.end <= range1.end) {\n      //                |-----------Range1----------|\n      //|-----------Range2----------|\n      range1.start = range2.start;\n      this.customTimeRangeArray.splice(rangeIndex2, 1);\n      return true;\n    } else if (range2.start <= range1.start && range1.start <= range2.end && range1.end <= range2.end) {\n      //      |--------Range1-------|\n      //|---------------Range2--------------|\n      this.customTimeRangeArray.splice(rangeIndex1, 1);\n      return true;\n    } else if (range1.start <= range2.start && range2.start <= range1.end && range2.end <= range1.end) {\n      //|-----------------Range1--------------|\n      //        |-----------Range2----------|\n      this.customTimeRangeArray.splice(rangeIndex2, 1);\n      return true;\n    }\n\n    return false;\n  }\n\n  function start(index) {\n    (0, _SupervisorTools.checkInteger)(index);\n\n    if (index >= this.customTimeRangeArray.length || index < 0) {\n      return NaN;\n    }\n\n    return this.customTimeRangeArray[index].start;\n  }\n\n  function end(index) {\n    (0, _SupervisorTools.checkInteger)(index);\n\n    if (index >= this.customTimeRangeArray.length || index < 0) {\n      return NaN;\n    }\n\n    return this.customTimeRangeArray[index].end;\n  }\n\n  return {\n    customTimeRangeArray: customTimeRangeArray,\n    length: length,\n    add: add,\n    clear: clear,\n    remove: remove,\n    mergeRanges: mergeRanges,\n    start: start,\n    end: end\n  };\n}\n\nCustomTimeRanges.__dashjs_factory_name = 'CustomTimeRanges';\nexports.default = _FactoryMaker2.default.getClassFactory(CustomTimeRanges);","map":{"version":3,"sources":["../../../../../src/streaming/utils/CustomTimeRanges.js"],"names":["customTimeRangeArray","length","i","start","end","range1","range2","index","add","clear","remove","mergeRanges","CustomTimeRanges","FactoryMaker"],"mappings":";;;;;;AA8BA,IAAA,aAAA,GAAA,OAAA,CAAA,yBAAA,CAAA;;;;AACA,IAAA,gBAAA,GAAA,OAAA,CAAA,0BAAA,CAAA;;;;;;AA/BA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA,SAAA,gBAAA;AAA0B;AAAY;AAClC,MAAIA,oBAAAA,GAAJ,EAAA;AACA,MAAIC,MAAAA,GAAJ,CAAA;;AAEA,WAAA,GAAA,CAAA,KAAA,EAAA,GAAA,EAAyB;AACrB,QAAIC,CAAAA,GAAJ,CAAA;;AAEA,SAAKA,CAAAA,GAAL,CAAA,EAAaA,CAAAA,GAAI,KAAA,oBAAA,CAAL,MAACA,IAA0CC,KAAAA,GAAQ,KAAA,oBAAA,CAAA,CAAA,EAA/D,KAAA,EAAoGD,CAApG,EAAA,EAAA,CAEA;;AAAA,SAAA,oBAAA,CAAA,MAAA,CAAA,CAAA,EAAA,CAAA,EAAuC;AAACC,MAAAA,KAAAA,EAAD,KAAA;AAAcC,MAAAA,GAAAA,EAArD;AAAuC,KAAvC;;AAEA,SAAKF,CAAAA,GAAL,CAAA,EAAYA,CAAAA,GAAI,KAAA,oBAAA,CAAA,MAAA,GAAhB,CAAA,EAAsDA,CAAtD,EAAA,EAA2D;AACvD,UAAI,KAAA,WAAA,CAAA,CAAA,EAAmBA,CAAAA,GAAvB,CAAI,CAAJ,EAA+B;AAC3BA,QAAAA,CAAAA;AAEP;AACD;;AAAA,SAAA,MAAA,GAAc,KAAA,oBAAA,CAAd,MAAA;AAGJ;;AAAA,WAAA,KAAA,GAAiB;AACb,SAAA,oBAAA,GAAA,EAAA;AACA,SAAA,MAAA,GAAA,CAAA;AAGJ;;AAAA,WAAA,MAAA,CAAA,KAAA,EAAA,GAAA,EAA4B;AACxB,SAAK,IAAIA,CAAAA,GAAT,CAAA,EAAgBA,CAAAA,GAAI,KAAA,oBAAA,CAApB,MAAA,EAAsDA,CAAtD,EAAA,EAA2D;AACvD,UAAIC,KAAAA,IAAS,KAAA,oBAAA,CAAA,CAAA,EAATA,KAAAA,IAA+CC,GAAAA,IAAO,KAAA,oBAAA,CAAA,CAAA,EAA1D,GAAA,EAA4F;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAA,oBAAA,CAAA,MAAA,CAAA,CAAA,EAAA,CAAA;AACAF,QAAAA,CAAAA;AAVJ,OAAA,MAYO,IAAIC,KAAAA,GAAQ,KAAA,oBAAA,CAAA,CAAA,EAARA,KAAAA,IAA8CC,GAAAA,GAAM,KAAA,oBAAA,CAAA,CAAA,EAAxD,GAAA,EAA0F;AAC7F;AACA;AACA,aAAA,oBAAA,CAAA,MAAA,CAAiCF,CAAAA,GAAjC,CAAA,EAAA,CAAA,EAA2C;AAACC,UAAAA,KAAAA,EAAD,GAAA;AAAYC,UAAAA,GAAAA,EAAK,KAAA,oBAAA,CAAA,CAAA,EAA5D;AAA2C,SAA3C;AACA,aAAA,oBAAA,CAAA,CAAA,EAAA,GAAA,GAAA,KAAA;AACA;AALG,OAAA,MAMA,IAAKD,KAAAA,GAAQ,KAAA,oBAAA,CAAA,CAAA,EAARA,KAAAA,IAA8CA,KAAAA,GAAQ,KAAA,oBAAA,CAAA,CAAA,EAA3D,GAAA,EAA6F;AAChG;AACA;AACA;AACA;AACA;AACA,aAAA,oBAAA,CAAA,CAAA,EAAA,GAAA,GAAA,KAAA;AANG,OAAA,MAOA,IAAKC,GAAAA,GAAM,KAAA,oBAAA,CAAA,CAAA,EAANA,KAAAA,IAA4CA,GAAAA,GAAM,KAAA,oBAAA,CAAA,CAAA,EAAvD,GAAA,EAAyF;AAC5F;AACA;AACA;AACA;AACA;AACA,aAAA,oBAAA,CAAA,CAAA,EAAA,KAAA,GAAA,GAAA;AAEP;AAED;;AAAA,SAAA,MAAA,GAAc,KAAA,oBAAA,CAAd,MAAA;AAGJ;;AAAA,WAAA,WAAA,CAAA,WAAA,EAAA,WAAA,EAA+C;AAC3C,QAAIC,MAAAA,GAAS,KAAA,oBAAA,CAAb,WAAa,CAAb;AACA,QAAIC,MAAAA,GAAS,KAAA,oBAAA,CAAb,WAAa,CAAb;;AAEA,QAAID,MAAAA,CAAAA,KAAAA,IAAiBC,MAAAA,CAAjBD,KAAAA,IAAiCC,MAAAA,CAAAA,KAAAA,IAAgBD,MAAAA,CAAjDA,GAAAA,IAA+DA,MAAAA,CAAAA,GAAAA,IAAcC,MAAAA,CAAjF,GAAA,EAA6F;AACzF;AACA;AACAD,MAAAA,MAAAA,CAAAA,GAAAA,GAAaC,MAAAA,CAAbD,GAAAA;AACA,WAAA,oBAAA,CAAA,MAAA,CAAA,WAAA,EAAA,CAAA;AACA,aAAA,IAAA;AALJ,KAAA,MAOO,IAAIC,MAAAA,CAAAA,KAAAA,IAAgBD,MAAAA,CAAhBC,KAAAA,IAAgCD,MAAAA,CAAAA,KAAAA,IAAgBC,MAAAA,CAAhDA,GAAAA,IAA8DA,MAAAA,CAAAA,GAAAA,IAAcD,MAAAA,CAAhF,GAAA,EAA4F;AAC/F;AACA;AACAA,MAAAA,MAAAA,CAAAA,KAAAA,GAAeC,MAAAA,CAAfD,KAAAA;AACA,WAAA,oBAAA,CAAA,MAAA,CAAA,WAAA,EAAA,CAAA;AACA,aAAA,IAAA;AALG,KAAA,MAMA,IAAIC,MAAAA,CAAAA,KAAAA,IAAgBD,MAAAA,CAAhBC,KAAAA,IAAgCD,MAAAA,CAAAA,KAAAA,IAAgBC,MAAAA,CAAhDA,GAAAA,IAA8DD,MAAAA,CAAAA,GAAAA,IAAcC,MAAAA,CAAhF,GAAA,EAA4F;AAC/F;AACA;AACA,WAAA,oBAAA,CAAA,MAAA,CAAA,WAAA,EAAA,CAAA;AACA,aAAA,IAAA;AAJG,KAAA,MAKA,IAAID,MAAAA,CAAAA,KAAAA,IAAgBC,MAAAA,CAAhBD,KAAAA,IAAgCC,MAAAA,CAAAA,KAAAA,IAAgBD,MAAAA,CAAhDA,GAAAA,IAA8DC,MAAAA,CAAAA,GAAAA,IAAcD,MAAAA,CAAhF,GAAA,EAA4F;AAC/F;AACA;AACA,WAAA,oBAAA,CAAA,MAAA,CAAA,WAAA,EAAA,CAAA;AACA,aAAA,IAAA;AAEJ;;AAAA,WAAA,KAAA;AAGJ;;AAAA,WAAA,KAAA,CAAA,KAAA,EAAsB;AAClB,KAAA,GAAA,gBAAA,CAAA,YAAA,EAAA,KAAA;;AAEA,QAAIE,KAAAA,IAAS,KAAA,oBAAA,CAATA,MAAAA,IAA6CA,KAAAA,GAAjD,CAAA,EAA4D;AACxD,aAAA,GAAA;AAGJ;;AAAA,WAAO,KAAA,oBAAA,CAAA,KAAA,EAAP,KAAA;AAGJ;;AAAA,WAAA,GAAA,CAAA,KAAA,EAAoB;AAChB,KAAA,GAAA,gBAAA,CAAA,YAAA,EAAA,KAAA;;AAEA,QAAIA,KAAAA,IAAS,KAAA,oBAAA,CAATA,MAAAA,IAA6CA,KAAAA,GAAjD,CAAA,EAA4D;AACxD,aAAA,GAAA;AAGJ;;AAAA,WAAO,KAAA,oBAAA,CAAA,KAAA,EAAP,GAAA;AAGJ;;AAAA,SAAO;AACHP,IAAAA,oBAAAA,EADG,oBAAA;AAEHC,IAAAA,MAAAA,EAFG,MAAA;AAGHO,IAAAA,GAAAA,EAHG,GAAA;AAIHC,IAAAA,KAAAA,EAJG,KAAA;AAKHC,IAAAA,MAAAA,EALG,MAAA;AAMHC,IAAAA,WAAAA,EANG,WAAA;AAOHR,IAAAA,KAAAA,EAPG,KAAA;AAQHC,IAAAA,GAAAA,EARJ;AAAO,GAAP;AAWJQ;;AAAAA,gBAAAA,CAAAA,qBAAAA,GAAAA,kBAAAA;kBACeC,cAAAA,CAAAA,OAAAA,CAAAA,eAAAA,CAAAA,gBAAAA,C","sourcesContent":["/**\n* The copyright in this software is being made available under the BSD License,\n* included below. This software may be subject to other third party and contributor\n* rights, including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2013, Dash Industry Forum.\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification,\n* are permitted provided that the following conditions are met:\n*  * Redistributions of source code must retain the above copyright notice, this\n*  list of conditions and the following disclaimer.\n*  * Redistributions in binary form must reproduce the above copyright notice,\n*  this list of conditions and the following disclaimer in the documentation and/or\n*  other materials provided with the distribution.\n*  * Neither the name of Dash Industry Forum nor the names of its\n*  contributors may be used to endorse or promote products derived from this software\n*  without specific prior written permission.\n*\n*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n*  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n*  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n*  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n*  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n*  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n*  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n*  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n*  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n*  POSSIBILITY OF SUCH DAMAGE.\n*/\nimport FactoryMaker from '../../core/FactoryMaker';\nimport { checkInteger } from '../utils/SupervisorTools';\n\nfunction CustomTimeRanges(/*config*/) {\n    let customTimeRangeArray = [];\n    let length = 0;\n\n    function add(start, end) {\n        let i = 0;\n\n        for (i = 0; (i < this.customTimeRangeArray.length) && (start > this.customTimeRangeArray[i].start); i++);\n\n        this.customTimeRangeArray.splice(i, 0, {start: start,end: end});\n\n        for (i = 0; i < this.customTimeRangeArray.length - 1; i++) {\n            if (this.mergeRanges(i,i + 1)) {\n                i--;\n            }\n        }\n        this.length = this.customTimeRangeArray.length;\n    }\n\n    function clear() {\n        this.customTimeRangeArray = [];\n        this.length = 0;\n    }\n\n    function remove(start, end) {\n        for (let i = 0; i < this.customTimeRangeArray.length; i++) {\n            if (start <= this.customTimeRangeArray[i].start && end >= this.customTimeRangeArray[i].end) {\n                //      |--------------Range i-------|\n                //|---------------Range to remove ---------------|\n                //    or\n                //|--------------Range i-------|\n                //|--------------Range to remove ---------------|\n                //    or\n                //                 |--------------Range i-------|\n                //|--------------Range to remove ---------------|\n                this.customTimeRangeArray.splice(i,1);\n                i--;\n\n            } else if (start > this.customTimeRangeArray[i].start && end < this.customTimeRangeArray[i].end) {\n                //|-----------------Range i----------------|\n                //        |-------Range to remove -----|\n                this.customTimeRangeArray.splice(i + 1, 0, {start: end,end: this.customTimeRangeArray[i].end});\n                this.customTimeRangeArray[i].end = start;\n                break;\n            } else if ( start > this.customTimeRangeArray[i].start && start < this.customTimeRangeArray[i].end) {\n                //|-----------Range i----------|\n                //                    |---------Range to remove --------|\n                //    or\n                //|-----------------Range i----------------|\n                //            |-------Range to remove -----|\n                this.customTimeRangeArray[i].end = start;\n            } else if ( end > this.customTimeRangeArray[i].start && end < this.customTimeRangeArray[i].end) {\n                //                     |-----------Range i----------|\n                //|---------Range to remove --------|\n                //            or\n                //|-----------------Range i----------------|\n                //|-------Range to remove -----|\n                this.customTimeRangeArray[i].start = end;\n            }\n        }\n\n        this.length = this.customTimeRangeArray.length;\n    }\n\n    function mergeRanges(rangeIndex1, rangeIndex2) {\n        let range1 = this.customTimeRangeArray[rangeIndex1];\n        let range2 = this.customTimeRangeArray[rangeIndex2];\n\n        if (range1.start <=  range2.start && range2.start <= range1.end && range1.end <= range2.end) {\n            //|-----------Range1----------|\n            //                    |-----------Range2----------|\n            range1.end = range2.end;\n            this.customTimeRangeArray.splice(rangeIndex2,1);\n            return true;\n\n        } else if (range2.start <= range1.start && range1.start <= range2.end && range2.end <= range1.end) {\n            //                |-----------Range1----------|\n            //|-----------Range2----------|\n            range1.start = range2.start;\n            this.customTimeRangeArray.splice(rangeIndex2,1);\n            return true;\n        } else if (range2.start <= range1.start && range1.start <= range2.end && range1.end <= range2.end) {\n            //      |--------Range1-------|\n            //|---------------Range2--------------|\n            this.customTimeRangeArray.splice(rangeIndex1,1);\n            return true;\n        } else if (range1.start <= range2.start && range2.start <= range1.end && range2.end <= range1.end) {\n            //|-----------------Range1--------------|\n            //        |-----------Range2----------|\n            this.customTimeRangeArray.splice(rangeIndex2,1);\n            return true;\n        }\n        return false;\n    }\n\n    function start(index) {\n        checkInteger(index);\n\n        if (index >= this.customTimeRangeArray.length || index < 0) {\n            return NaN;\n        }\n\n        return this.customTimeRangeArray[index].start;\n    }\n\n    function end(index) {\n        checkInteger(index);\n\n        if (index >= this.customTimeRangeArray.length || index < 0) {\n            return NaN;\n        }\n\n        return this.customTimeRangeArray[index].end;\n    }\n\n    return {\n        customTimeRangeArray: customTimeRangeArray,\n        length: length,\n        add: add,\n        clear: clear,\n        remove: remove,\n        mergeRanges: mergeRanges,\n        start: start,\n        end: end\n    };\n}\nCustomTimeRanges.__dashjs_factory_name = 'CustomTimeRanges';\nexport default FactoryMaker.getClassFactory(CustomTimeRanges);\n"]},"metadata":{},"sourceType":"script"}