{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _IsoBox = require('../vo/IsoBox');\n\nvar _IsoBox2 = _interopRequireDefault(_IsoBox);\n\nvar _FactoryMaker = require('../../core/FactoryMaker');\n\nvar _FactoryMaker2 = _interopRequireDefault(_FactoryMaker);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/**\n* The copyright in this software is being made available under the BSD License,\n* included below. This software may be subject to other third party and contributor\n* rights, including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2013, Dash Industry Forum.\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification,\n* are permitted provided that the following conditions are met:\n*  * Redistributions of source code must retain the above copyright notice, this\n*  list of conditions and the following disclaimer.\n*  * Redistributions in binary form must reproduce the above copyright notice,\n*  this list of conditions and the following disclaimer in the documentation and/or\n*  other materials provided with the distribution.\n*  * Neither the name of Dash Industry Forum nor the names of its\n*  contributors may be used to endorse or promote products derived from this software\n*  without specific prior written permission.\n*\n*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n*  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n*  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n*  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n*  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n*  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n*  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n*  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n*  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n*  POSSIBILITY OF SUCH DAMAGE.\n*/\n\n\nfunction IsoFile() {\n  var instance = void 0,\n      parsedIsoFile = void 0;\n  /**\n  * @param {string} type\n  * @returns {IsoBox|null}\n  * @memberof IsoFile#\n  */\n\n  function getBox(type) {\n    if (!type || !parsedIsoFile || !parsedIsoFile.boxes || parsedIsoFile.boxes.length === 0 || typeof parsedIsoFile.fetch !== 'function') return null;\n    return convertToDashIsoBox(parsedIsoFile.fetch(type));\n  }\n  /**\n  * @param {string} type\n  * @returns {Array|null} array of {@link IsoBox}\n  * @memberof IsoFile#\n  */\n\n\n  function getBoxes(type) {\n    var boxes = [];\n\n    if (!type || !parsedIsoFile || typeof parsedIsoFile.fetchAll !== 'function') {\n      return boxes;\n    }\n\n    var boxData = parsedIsoFile.fetchAll(type);\n    var box = void 0;\n\n    for (var i = 0, ln = boxData.length; i < ln; i++) {\n      box = convertToDashIsoBox(boxData[i]);\n\n      if (box) {\n        boxes.push(box);\n      }\n    }\n\n    return boxes;\n  }\n  /**\n  * @param {string} value\n  * @memberof IsoFile#\n  */\n\n\n  function setData(value) {\n    parsedIsoFile = value;\n  }\n  /**\n  * @returns {IsoBox|null}\n  * @memberof IsoFile#\n  */\n\n\n  function getLastBox() {\n    if (!parsedIsoFile || !parsedIsoFile.boxes || !parsedIsoFile.boxes.length) return null;\n    var type = parsedIsoFile.boxes[parsedIsoFile.boxes.length - 1].type;\n    var boxes = getBoxes(type);\n    return boxes.length > 0 ? boxes[boxes.length - 1] : null;\n  }\n\n  function convertToDashIsoBox(boxData) {\n    if (!boxData) return null;\n    var box = new _IsoBox2.default(boxData);\n\n    if (boxData.hasOwnProperty('_incomplete')) {\n      box.isComplete = !boxData._incomplete;\n    }\n\n    return box;\n  }\n\n  instance = {\n    getBox: getBox,\n    getBoxes: getBoxes,\n    setData: setData,\n    getLastBox: getLastBox\n  };\n  return instance;\n}\n\nIsoFile.__dashjs_factory_name = 'IsoFile';\nexports.default = _FactoryMaker2.default.getClassFactory(IsoFile);","map":{"version":3,"sources":["../../../../../src/streaming/utils/IsoFile.js"],"names":["instance","parsedIsoFile","convertToDashIsoBox","boxes","boxData","box","i","ln","type","getBoxes","IsoBox","getBox","setData","getLastBox","IsoFile","FactoryMaker"],"mappings":"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","sourcesContent":["/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport IsoBox from '../vo/IsoBox';\nimport FactoryMaker from '../../core/FactoryMaker';\n\nfunction IsoFile() {\n\n    let instance,\n        parsedIsoFile;\n\n    /**\n    * @param {string} type\n    * @returns {IsoBox|null}\n    * @memberof IsoFile#\n    */\n    function getBox(type) {\n        if (!type || !parsedIsoFile || !parsedIsoFile.boxes || (parsedIsoFile.boxes.length === 0) || typeof parsedIsoFile.fetch !== 'function') return null;\n\n        return convertToDashIsoBox(parsedIsoFile.fetch(type));\n    }\n\n    /**\n    * @param {string} type\n    * @returns {Array|null} array of {@link IsoBox}\n    * @memberof IsoFile#\n    */\n    function getBoxes(type) {\n        let boxes = [];\n\n        if (!type || !parsedIsoFile || typeof parsedIsoFile.fetchAll !== 'function') {\n            return boxes;\n        }\n\n        let boxData = parsedIsoFile.fetchAll(type);\n        let box;\n\n        for (let i = 0, ln = boxData.length; i < ln; i++) {\n            box = convertToDashIsoBox(boxData[i]);\n\n            if (box) {\n                boxes.push(box);\n            }\n        }\n\n        return boxes;\n    }\n\n    /**\n    * @param {string} value\n    * @memberof IsoFile#\n    */\n    function setData(value) {\n        parsedIsoFile = value;\n    }\n\n    /**\n    * @returns {IsoBox|null}\n    * @memberof IsoFile#\n    */\n    function getLastBox() {\n        if (!parsedIsoFile || !parsedIsoFile.boxes || !parsedIsoFile.boxes.length) return null;\n\n        let type = parsedIsoFile.boxes[parsedIsoFile.boxes.length - 1].type;\n        let boxes = getBoxes(type);\n\n        return boxes.length > 0 ? boxes[boxes.length - 1] : null;\n    }\n\n    function convertToDashIsoBox(boxData) {\n        if (!boxData) return null;\n\n        let box = new IsoBox(boxData);\n\n        if (boxData.hasOwnProperty('_incomplete')) {\n            box.isComplete = !boxData._incomplete;\n        }\n\n        return box;\n    }\n\n    instance = {\n        getBox: getBox,\n        getBoxes: getBoxes,\n        setData: setData,\n        getLastBox: getLastBox\n    };\n\n    return instance;\n}\nIsoFile.__dashjs_factory_name = 'IsoFile';\nexport default FactoryMaker.getClassFactory(IsoFile);\n"]},"metadata":{},"sourceType":"script"}